@page
@model TutorDemand.RazorWebApp.Pages.TeachingSchedules.Index

<section class="flex flex-col">
    <div class="flex items-center justify-between gap-x-5 mt-8">
        <h3 class="text-3xl font-bold">Danh sách lịch học</h3>
        <a asp-page="/teachingschedules/create" class="text-white bg-primary focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center me-2 mb-2">
            Tạo lịch học
        </a>
    </div>

    <div class="relative overflow-x-auto shadow-md sm:rounded-lg mt-4">
        <table class="w-full text-sm text-left rtl:text-right text-gray-500">
            <thead class="text-xs text-white uppercase bg-primary">
            <tr>
                <th scope="col" class="px-6 py-3">
                    <div class="flex items-center text-nowrap">
                        Môn học
                    </div>
                </th>
                <th scope="col" class="px-6 py-3">
                    <div class="flex items-center text-nowrap">
                        Giảng viên
                    </div>
                </th>
                <th scope="col" class="px-6 py-3">
                    <div class="flex items-center text-nowrap">
                        Slot
                    </div>
                </th>
                <th scope="col" class="px-6 py-3">
                    <div class="flex items-center text-nowrap">
                        Mã phòng
                    </div>
                </th>
                <th scope="col" class="px-6 py-3">
                    <div class="flex items-center text-nowrap">
                        Mật khẩu
                    </div>
                </th>
                <th scope="col" class="px-6 py-3">
                    <div class="flex items-center text-nowrap">
                        Ngày học
                    </div>
                </th>
                <th scope="col" class="px-6 py-3">
                    <div class="flex items-center text-nowrap">
                        Bắt đầu
                    </div>
                </th>
                <th scope="col" class="px-6 py-3">
                    <div class="flex items-center text-nowrap">
                        Kết thúc
                    </div>
                </th>
                <th scope="col" class="px-6 py-3 text-center">
                    Actions
                </th>
            </tr>
            </thead>
            <tbody>
            @foreach (var teachingSchedule in Model.TeachingSchedules)
            {
                <tr class="bg-white border-b">
                    <th scope="row" class="px-6 py-4 text-nowrap font-medium text-gray-900 whitespace-nowrap">
                        @teachingSchedule.Subject.Name
                    </th>
                    <td class="px-6 py-4 text-nowrap">
                        @teachingSchedule.Tutor.Fullname
                    </td>
                    <td class="px-6 py-4 text-nowrap">
                        @teachingSchedule.Slot.SlotName
                    </td>
                    <td class="px-6 py-4 text-nowrap">
                        @teachingSchedule.MeetRoomCode
                    </td>
                    <td class="px-6 py-4 text-nowrap">
                        @teachingSchedule.RoomPassword
                    </td>
                    <td class="px-6 py-4 text-nowrap">
                        @teachingSchedule.RoomPassword
                    </td>
                    <td class="px-6 py-4 text-nowrap">
                        @teachingSchedule.StartDate
                    </td>
                    <td class="px-6 py-4 text-nowrap">
                        @teachingSchedule.EndDate
                    </td>
                    <td class="px-6 py-4 flex justify-center gap-x-2">
                        <a asp-page="/teachingschedules/detail" asp-route-id="@teachingSchedule.TeachingScheduleId" class="font-medium text-white bg-info rounded-md py-2 px-4">Xem</a>
                        <a asp-page="/teachingschedules/update" asp-route-id="@teachingSchedule.TeachingScheduleId" class="font-medium text-white bg-warning rounded-md py-2 px-4">Sửa</a>
                        <form method="post" asp-page="/teachingschedules/delete" asp-route-id="@teachingSchedule.TeachingScheduleId" onsubmit="return confirm('Are you sure you want to delete this item?');">
                            <button class="font-medium text-white bg-danger rounded-md py-2 px-4">Xóa</button>
                        </form>
                    </td>
                </tr>
            }

            </tbody>
        </table>
    </div>

    <div class="mx-auto flex items-center mt-6 gap-x-4">
        @if (Model.Metadata.HasPrevious)
        {
            <a href="/teachingschedules?pageSize=5&pageNumber=@(Model.Metadata.CurrentPage - 1)"
               class="font-medium text-slate-400 cursor-pointer hover:text-primary">
                Trước
            </a>
        }
        else
        {
            <div class="font-medium text-slate-400 cursor-not-allowed">Trước</div>
        }

        <div class="flex items-center">
            Trang @Model.Metadata.CurrentPage/@Model.Metadata.TotalPages
        </div>

        @if (Model.Metadata.HasNext)
        {
            <a href="/teachingschedules?pageSize=5&pageNumber=@(Model.Metadata.CurrentPage + 1)"
               class="font-medium text-slate-400 cursor-pointer hover:text-primary">
                Sau
            </a>
        }
        else
        {
            <div class="font-medium text-slate-400 cursor-not-allowed">Sau</div>
        }
    </div>
</section>

@section Scripts
{
    <script>
        let deletedId;
    
        function handleClickDelete(id){
            deletedId=id;
        }
        
         function deleteTeachingSchedule(){
            const form = document.createElement("form");
            form.method = "POST";
            form.action = "/teachingschedules?type=delete&id=" + deletedId;
             
            document.body.appendChild(form);
            form.submit();
         }
            
    </script>
}